{% extends 'base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Back Button -->
    <div class="mb-4">
        <a href="{% url 'vehicle-list' %}" class="text-blue-500 hover:text-blue-700">
            ‚Üê Back to Vehicle List
        </a>
    </div>

    <!-- Vehicle Header -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">{{ vehicle.plate_number }}</h1>
                <p class="text-lg text-gray-600">{{ vehicle.make }} {{ vehicle.model }} ({{ vehicle.year }})</p>
            </div>
            {% if user.is_staff %}
            <div class="flex space-x-4">
                <a href="#" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Edit Vehicle
                </a>
                <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                    Delete Vehicle
                </button>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Vehicle Details -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Owner Information -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">Owner Information</h2>
            <div class="space-y-3">
                <div>
                    <label class="text-gray-600">Full Name</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.owner_name }}</p>
                </div>
                <div>
                    <label class="text-gray-600">Phone Number</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.owner_phone }}</p>
                </div>
                <div>
                    <label class="text-gray-600">Address</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.owner_address }}</p>
                </div>
            </div>
        </div>

        <!-- Vehicle Information -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">Vehicle Details</h2>
            <div class="space-y-3">
                <div>
                    <label class="text-gray-600">Vehicle Type</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.vehicle_type }}</p>
                </div>
                <div>
                    <label class="text-gray-600">Color</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.color }}</p>
                </div>
                <div>
                    <label class="text-gray-600">Registration Date</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.registration_date|date:"F d, Y" }}</p>
                </div>
            </div>
        </div>

        <!-- Documentation Status -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">Documentation Status</h2>
            <div class="space-y-3">
                <div>
                    <label class="text-gray-600">Insurance Expiry</label>
                    <p class="text-gray-900 font-medium {% if vehicle.insurance_expiry < today %}text-red-600{% endif %}">
                        {{ vehicle.insurance_expiry|date:"F d, Y" }}
                        {% if vehicle.insurance_expiry < today %}
                        <span class="text-red-500 font-bold">(EXPIRED)</span>
                        {% endif %}
                    </p>
                </div>
                <div>
                    <label class="text-gray-600">Last Inspection Date</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.last_inspection_date|date:"F d, Y" }}</p>
                </div>
                <div>
                    <label class="text-gray-600">Record Created</label>
                    <p class="text-gray-900 font-medium">{{ vehicle.created_at|date:"F d, Y" }}</p>
                </div>
            </div>
        </div>

        <!-- Detection History -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">Recent Detections</h2>
            <div class="space-y-3">
                {% for detection in vehicle.platedetection_set.all|slice:":5" %}
                <div class="border-b pb-2">
                    <p class="text-gray-900">Detected on {{ detection.timestamp|date:"F d, Y H:i" }}</p>
                    <p class="text-gray-600">Confidence: {{ detection.confidence|floatformat:2 }}%</p>
                </div>
                {% empty %}
                <p class="text-gray-500">No detection history available</p>
                {% endfor %}
            </div>
            {% if vehicle.platedetection_set.count > 5 %}
            <a href="#" class="text-blue-500 hover:text-blue-700 mt-4 inline-block">
                View all detections
            </a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}